name: Get file summary using OpenAI

on:
  push:
    branches:
      - main

jobs:
  get-file-summary:
    runs-on: ubuntu-latest
    steps:
    - name: Checkout code
      uses: actions/checkout@v2

    - name: Concatenate current and previous file contents
      run: |
        # get the file contents from the current commit
        current_contents=$(cat test.py)

        # print the combined contents
        echo "$current_contents"

    - name: pip install openai
      run: |
        pip install openai

    - name: Get file summary from OpenAI
      run: |
        # Call openai api
        openai api completions.create \
          --engine ada \
          --prompt "Summarize: $current_contents" \
          --max_tokens 256 \
          --temperature 0.7 \
          --top_p 1 \
          --frequency_penalty 0 \
          --presence_penalty 0 \
          --stop "###"

